---
import { getCollection } from 'astro:content';
import Base from '../../layouts/Base.astro';
import BaseHead from '../../components/BaseHead.astro';
import FeaturedPost from '../../components/FeaturedPost.astro'
import '../../styles/blog.css'

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
const featuredPosts = posts.filter(post => post.data.featured)
---

<Base>
	<BaseHead title='Blog' description='My Blog' image='/assets/images/cabinets2.jpg'>

    <section id="int-hero">
        <h1 id="home-h">Blog</h1>
        <picture>
            <source media="(max-width: 600px)" srcset="/assets/images/cabinets2-m.jpg">
            <source media="(min-width: 601px)" srcset="/assets/images/cabinets2.jpg">
            <img aria-hidden="true" decoding="async" src="/assets/images/cabinets2.jpg" alt="kitchen cabinets" loading="eager" width="2500" height="1667">
        </picture>
    </section>

    <!-- ============================================ -->
    <!--              Main Blog Content               -->
    <!-- ============================================ -->

    <div class="blog-container main-content-wrapper">
        <!--Main content -->
        <div class="main-content">
            <!-- ============================================ -->
            <!--                 Blog Articles                -->
            <!-- ============================================ -->
			{
				posts.map((post) => (
				<article class="recent-articles">
                        <!--Main Article Image-->
                        <picture class="blog-mainImage">
                            <img
                            src={post.data.heroImage }
                            alt={ post.data.imageAlt }
                            width="795"
                            height="400"
                            decoding="async"/>
                        </picture>
                        <!--Article Info-->
                        <div class="article-group">
                            <div class="blog-authorGroup">
                                <!--Author Image-->
                                <picture class="blog-author-img">
                                    <img
                                    src="/assets/svgs/profile.svg"
                                    alt="house"
                                    width="32"
                                    height="32"
                                    decoding="async"/>
                                </picture>
                                <span class="blog-author">{ post.data.author }</span>
                                <span aria-hidden="true" class="blog-dot"></span>
                                <!--Blog Date-->
                                <span class="blog-date">{ post.data.pubDate }</span>
                            </div>
                            <h2 class="blog-h1">
                                { post.data.title }
                            </h2>
                            <p class="blog-desc">
                                { post.data.description }
                            </p>
                            <a href={ post.slug } class="blog-link">Continue Reading</a>
                        </div>
                    </article>
				))
			}
        </div>

        { featuredPosts.length > 0 && <FeaturedPost posts={featuredPosts}/>}
    </div>
</Base>